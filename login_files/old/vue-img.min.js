/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/vue-img@2.11.10/dist/vue-img.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueImg=e()}(this,function(){"use strict";var t=window.navigator.userAgent,e=/iphone|ios|ipad|ipod/i.test(t),r=/AliApp\(AP\/([\d.]+)\)/i.test(t),n=Object.create(null);n.canWebp=e&&r&&function(e){var r=t.match(/AlipayClient[a-zA-Z]*\/(\d+(?:\.\d+)+)/);r=(r=r&&r.length?r[1]:"").split("."),e=e.split(".");for(var n=0,o=void 0,a=void 0;n<r.length;n++){if((o=parseInt(e[n],10)||0)>(a=parseInt(r[n],10)||0))return-1;if(o<a)return 1}return 0}("10.1.0")>=0||!![].map&&0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp");var o="https:"===location.protocol?"https://":"http://",a=document.domain.match(/.(alpha|beta|ar).ele(net)?.me$/);n.cdn=n.qiniuCdn=o+(a?"fuss"+a[0]:"fuss10.elemecdn.com"),n.aliCdn=o+(a?"cube"+a[0]:"cube.elemecdn.com");var i=document.documentElement,u=function(t){var e=t.source,r=t.target;t.keys.forEach(function(t){var n,o;n=e,o=t,Object.prototype.hasOwnProperty.call(n,o)&&(r[t]=e[t])})},f=function(t,e,r){"img"===r?t.src=e:t.style.backgroundImage="url('"+e+"')"},c=function(t){var e,r=window.devicePixelRatio,n=document.documentElement.getAttribute("data-dpr"),o=n?r/n:r;try{e=+(i.getAttribute("style").match(/(\d+)/)||[])[1]}catch(t){var a=i.offsetWidth;e=a/r>540?540*r/10:a/10}return e*=o,Number(e)>=0&&"number"==typeof e?t*e/75:t},p=function(t){return t.replace(/^(\w)(\w\w)(\w{29}(\w*))$/,"/$1/$2/$3.$4")},s=function(t){void 0===t&&(t={});var e=t.hash,r=t.adapt,o=t.width,a=t.height,i=t.quality,u=t.format,f=t.fallback,s=t.prefix,l=t.suffix,d=t.urlFormatter,h=("string"==typeof s?s:n.aliCdn)+p(e);if(/(jpe?g|png|bmp|gif|webp|tiff)$/.test(e)){var m="number"==typeof i?"/quality,q_"+i:"",g=function(t){var e=t.width,r=t.height,n=t.adapt,o=e&&(n?c(e):e),a=r&&(n?c(r):r);return"number"==typeof o&&(o=Math.floor(o)),"number"==typeof a&&(a=Math.floor(a)),e&&r?"/resize,w_"+o+",h_"+a+",m_fixed":e?"/resize,w_"+o:r?"/resize,h_"+a:""}({width:o,height:a,adapt:r}),v=""+m+function(t){var e=t.format,r=t.fallback,o=/^(jpg|png|gif)$/;return o.test(e)?"/format,"+e:"jpeg"===e?"/format,jpg/interlace,1":n.canWebp?"/format,webp":o.test(r)?"/format,"+r:""}({format:u,fallback:f})+g+("string"==typeof l?l:"");h+=v?"?x-oss-process=image"+v:""}return"function"==typeof d&&(h=d(h)),h},l=function(t){void 0===t&&(t={});var e=t.hash,r=t.adapt,o=t.width,a=t.height,i=t.quality,u=t.format,f=t.fallback,s=t.prefix,l=t.suffix,d=t.urlFormatter,h="string"==typeof s?s:n.qiniuCdn,m=""+("number"==typeof i?"quality/"+i+"/":"")+function(t){var e=t.format,r=t.fallback,o=/^(jpg|jpeg|png|gif)$/;return o.test(e)?"format/"+e+"/":n.canWebp?"format/webp/":o.test(r)?"format/"+r+"/":""}({format:u,fallback:f})+function(t){var e=t.width,r=t.height,n=t.adapt,o=e&&(n?c(e):e),a=r&&(n?c(r):r),i="thumbnail/",u=o+"x"+a;return e&&r?i+"!"+u+"r/gravity/Center/crop/"+u+"/":e?""+i+o+"x/":r?i+"x"+a+"/":""}({width:o,height:a,adapt:r})+("string"==typeof l?l:""),g=h+p(e)+(m?"?imageMogr/"+m:"");return"function"==typeof d&&(g=d(g)),g},d=function(t){return void 0===t&&(t={}),t.hash&&"string"==typeof t.hash?"ali"===n.cdnProvider?s(t):l(t):""};return n.getSrc=d,n.install=function(t,e){void 0===e&&(e={}),Object.defineProperty(n,"cdnProvider",{value:"ali"===e.cdn?e.cdn:"qiniu",enumerable:!0,configurable:!1,writable:!1});var r=function(t){void 0===t&&(t={});var e=function(){u({source:t,target:this,keys:["loading","error","quality","delay","prefix","suffix","adapt"]})};return e.prototype.hashToSrc=function(t){var e={hash:t};return u({source:this,target:e,keys:["width","height","quality","format","fallback","adapt","prefix","suffix"]}),d(e)},function(t){function e(e){var r=e&&"object"==typeof e?e:{hash:e};t.call(this),u({source:r,target:this,keys:["hash","loading","error","width","height","quality","format","fallback","adapt","prefix","suffix","defer","urlFormatter"]})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toImageSrc=function(){return this.hashToSrc(this.hash)},e.prototype.toLoadingSrc=function(){return this.hashToSrc(this.loading)},e.prototype.toErrorSrc=function(){return this.hashToSrc(this.error)},e}(e)}(e),o=[],a=function(t,e,n){var o=new r(e.value),a=o.toImageSrc(),i=o.toErrorSrc();if(!a)return Promise.resolve();if(e.oldValue){var u=new r(e.oldValue);if(a===u.toImageSrc())return Promise.resolve()}var c=new Image,p=+o.delay||5e3;return new Promise(function(e){c.onload=function(){f(t,c.src,n.tag),e()},c.onerror=function(){var r=/format[\/,]webp\/?/;r.test(c.src)?c.src=a.replace(r,""):i&&(f(t,i,n.tag),e())},setTimeout(function(){e()},p),c.src=a})};t.directive("img",{bind:function(t,e,n){var i=new r(e.value).toLoadingSrc(),u=e.value.defer;i&&f(t,i,n.tag),u||o.push(a(t,e,n))},inserted:function(e,r,n){r.value.defer&&(function(t){var e=t.getBoundingClientRect();return e.top>0&&e.bottom<window.innerHeight&&e.left>0&&e.right<window.innerWidth}(e)?o.push(a(e,r,n)):t.nextTick(function(){Promise.all(o).then(function(){o.length=0,a(e,r,n)}).catch(function(){})}))},update:a})},n});